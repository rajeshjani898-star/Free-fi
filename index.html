<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeonTrade Elite - Green Protocol Final</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --neon-green: #00ff55;
            --neon-lime: #ccff00;
            --neon-red: #ff3333;
            --bg-deep: #000800;
            --glass: rgba(0, 255, 85, 0.05);
            --glass-border: 1px solid rgba(0, 255, 85, 0.3);
        }

        body {
            background: linear-gradient(180deg, #000000 0%, #051405 100%);
            color: #e0e0e0;
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
            min-height: 100vh;
        }

        .rajdhani { font-family: 'Rajdhani', sans-serif; text-transform: uppercase; letter-spacing: 1px; }

        .neon-panel {
            background: var(--glass);
            backdrop-filter: blur(12px);
            border: var(--glass-border);
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 255, 85, 0.1);
        }

        #chartWrapper { background: #000; position: relative; border-radius: 8px; overflow: hidden; height: 420px; border: 1px solid #111; }
        .ticker { position: absolute; top: 15px; right: 25px; font-size: 1.8rem; font-family: 'Rajdhani'; z-index: 10; padding: 5px 15px; background: rgba(0,0,0,0.6); border-radius: 4px; border: 1px solid currentColor; }

        .btn-cyber { font-family: 'Rajdhani'; font-weight: 700; transition: 0.3s; border-radius: 4px; }
        .btn-long { border: 1px solid var(--neon-green); color: var(--neon-green); }
        .btn-long:hover { background: var(--neon-green); color: #000; box-shadow: 0 0 25px var(--neon-green); }
        .btn-short { border: 1px solid var(--neon-red); color: var(--neon-red); }
        .btn-short:hover { background: var(--neon-red); color: #000; box-shadow: 0 0 25px var(--neon-red); }
        
        .ai-active { background: var(--neon-lime) !important; color: #000 !important; box-shadow: 0 0 20px var(--neon-lime); }
        
        #appScreen { display: none; }
        .log-entry { font-size: 0.75rem; border-bottom: 1px solid rgba(255,255,255,0.05); padding: 5px 0; font-family: 'Courier New', monospace; }
    </style>
</head>
<body>

    <div id="loader" class="vh-100 d-flex flex-column justify-content-center align-items-center">
        <div class="spinner-grow text-success" role="status"></div>
        <div class="rajdhani text-success mt-3 h5">SYNCHRONIZING REPOSITORY...</div>
    </div>

    <div id="authScreen" class="vh-100 d-flex align-items-center justify-content-center" style="display:none;">
        <div class="neon-panel p-5 text-center" data-aos="zoom-in" style="width: 420px;">
            <i class="bi bi-cpu-fill text-success h1"></i>
            <h1 class="rajdhani text-success mb-2">NEONTRADE</h1>
            <p class="text-muted small mb-4">MASTER ADMIN ACCESS</p>
            <button class="btn btn-long w-100 py-2 btn-cyber" onclick="initApp()">CONNECT UPLINK</button>
        </div>
    </div>

    <div id="appScreen" class="container-fluid py-3 px-4">
        <div class="d-flex justify-content-between align-items-end mb-4">
            <div>
                <div class="text-muted small rajdhani">Liquid Assets</div>
                <h2 class="rajdhani text-success mb-0">₹<span id="balDisplay">1000.00</span></h2>
            </div>
            <div class="d-flex gap-3">
                <button class="btn btn-outline-info btn-sm btn-cyber" onclick="exportLogs()"><i class="bi bi-download"></i> EXPORT REPORT</button>
                <button id="aiBtn" class="btn btn-outline-warning btn-sm btn-cyber" onclick="toggleAI()"><i class="bi bi-cpu"></i> AI PATTERN: OFF</button>
                <button class="btn btn-outline-danger btn-sm" onclick="resetSystem()"><i class="bi bi-arrow-counterclockwise"></i> RESET</button>
            </div>
        </div>

        <div class="row g-4">
            <div class="col-lg-9">
                <div class="neon-panel p-1 mb-4" id="chartWrapper">
                    <div id="priceTicker" class="ticker text-success">0.00</div>
                    <canvas id="mainChart"></canvas>
                </div>
                <div class="row g-3">
                    <div class="col-md-4"><div class="neon-panel p-3 text-center"><small class="text-muted rajdhani d-block">Win Rate</small><span id="statWinRate" class="rajdhani h4">0%</span></div></div>
                    <div class="col-md-4"><div class="neon-panel p-3 text-center text-success"><small class="text-muted rajdhani d-block">Profit/Loss</small><span id="statRevenue" class="rajdhani h4">₹0</span></div></div>
                    <div class="col-md-4"><div class="neon-panel p-3 text-center text-info"><small class="text-muted rajdhani d-block">Trades</small><span id="statTotal" class="rajdhani h4">0</span></div></div>
                </div>
            </div>

            <div class="col-lg-3">
                <div class="neon-panel p-4 mb-4">
                    <h5 class="rajdhani mb-4 text-center">Execution</h5>
                    <div class="mb-4">
                        <label class="small text-muted rajdhani">Position Size (₹)</label>
                        <input type="number" id="tradeAmt" class="form-control bg-dark text-white rajdhani fs-4 text-center" value="100">
                    </div>
                    <div class="row g-2 mb-4">
                        <div class="col-6"><button class="btn btn-long w-100 py-3 btn-cyber h5 m-0" onclick="executeTrade('LONG')">LONG</button></div>
                        <div class="col-6"><button class="btn btn-short w-100 py-3 btn-cyber h5 m-0" onclick="executeTrade('SHORT')">SHORT</button></div>
                    </div>
                </div>
                <div class="neon-panel p-3">
                    <h6 class="rajdhani text-muted mb-3 border-bottom border-secondary pb-2">Terminal Logs</h6>
                    <div id="txLog" class="log-container" style="height: 250px; overflow-y: auto;"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        let balance = parseFloat(localStorage.getItem('nt_balance')) || 1000.00;
        let stats = JSON.parse(localStorage.getItem('nt_stats')) || { wins: 0, total: 0, revenue: 0 };
        let history = JSON.parse(localStorage.getItem('nt_history')) || [];
        let currentPrice = 68420.50;
        let aiEnabled = false, forcedTrend = null, candles = [];

        const canvas = document.getElementById('mainChart');
        const ctx = canvas.getContext('2d');

        function initApp() {
            document.getElementById('authScreen').style.display = 'none';
            document.getElementById('appScreen').style.display = 'block';
            AOS.init();
            resizeCanvas();
            seedMarket();
            updateUI();
            history.forEach(entry => log(entry.msg, entry.color, false));
            log("UPLINK STABLE. PROTOCOL RESUMED.", "text-success");
        }

        window.onload = () => {
            setTimeout(() => {
                document.getElementById('loader').style.display = 'none';
                document.getElementById('authScreen').style.display = 'flex';
            }, 1000);
            window.addEventListener('resize', resizeCanvas);
        };

        function resizeCanvas() {
            canvas.width = canvas.parentElement.clientWidth;
            canvas.height = canvas.parentElement.clientHeight;
        }

        function seedMarket() {
            for(let i=0; i<60; i++) addCandle();
            setInterval(() => { addCandle(); drawChart(); }, 2000);
        }

        function addCandle() {
            let open = candles.length > 0 ? candles[candles.length - 1].close : currentPrice;
            let move = (Math.random() - 0.5) * 60;
            if (forcedTrend === 'up') move = Math.abs(move) + 20;
            if (forcedTrend === 'down') move = -Math.abs(move) - 20;
            let close = open + move;
            let high = Math.max(open, close) + Math.random() * 10;
            let low = Math.min(open, close) - Math.random() * 10;
            currentPrice = close;
            candles.push({ open, close, high, low });
            if (candles.length > 80) candles.shift();
            document.getElementById('priceTicker').innerText = currentPrice.toFixed(2);
            document.getElementById('priceTicker').style.color = close >= open ? 'var(--neon-green)' : 'var(--neon-red)';
        }

        function drawChart() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            const w = canvas.width / candles.length;
            const max = Math.max(...candles.map(c => c.high)) + 10;
            const min = Math.min(...candles.map(c => c.low)) - 10;
            const range = max - min;
            const getY = (p) => canvas.height - ((p - min) / range) * canvas.height;
            candles.forEach((c, i) => {
                const x = i * w;
                ctx.strokeStyle = c.close >= c.open ? '#00ff55' : '#ff3333';
                ctx.beginPath(); ctx.moveTo(x + w/2, getY(c.high)); ctx.lineTo(x + w/2, getY(c.low)); ctx.stroke();
                ctx.fillStyle = ctx.strokeStyle;
                ctx.fillRect(x + 3, getY(Math.max(c.open, c.close)), w - 6, Math.abs(getY(c.open) - getY(c.close)) + 1);
            });
        }

        function executeTrade(type) {
            const amt = parseFloat(document.getElementById('tradeAmt').value);
            if (amt > balance) return log("ERROR: INSUFFICIENT BALANCE", "text-danger");
            balance -= amt; updateUI();
            log(`EXEC: ${type} @ ${currentPrice.toFixed(2)}`, "text-warning");
            let entry = currentPrice;
            setTimeout(() => {
                const isWin = type === 'LONG' ? currentPrice > entry : currentPrice < entry;
                if (isWin) {
                    let win = amt * 1.85; balance += win; stats.wins++; stats.revenue += (win - amt);
                    log(`PROFIT: +₹${(win - amt).toFixed(2)}`, "text-success");
                } else {
                    log(`LOSS: -₹${amt.toFixed(2)}`, "text-danger");
                }
                stats.total++; saveState(); updateUI();
            }, 5000);
        }

        function toggleAI() {
            aiEnabled = !aiEnabled;
            const btn = document.getElementById('aiBtn');
            if(aiEnabled) {
                btn.classList.add('ai-active'); btn.innerHTML = '<i class="bi bi-cpu-fill"></i> AI PATTERN: ON';
                log("AI OVERRIDE: TARGETING VOLATILITY", "text-info");
                setTimeout(() => {
                    forcedTrend = Math.random() > 0.5 ? 'up' : 'down';
                    log(`AI SIGNAL: MARKET SHORTING ${forcedTrend.toUpperCase()}`, "text-lime");
                    setTimeout(() => forcedTrend = null, 8000);
                }, 1000);
            } else { btn.classList.remove('ai-active'); btn.innerHTML = '<i class="bi bi-cpu"></i> AI PATTERN: OFF'; forcedTrend = null; }
        }

        function updateUI() {
            document.getElementById('balDisplay').innerText = balance.toFixed(2);
            document.getElementById('statRevenue').innerText = `₹${stats.revenue.toFixed(0)}`;
            document.getElementById('statTotal').innerText = stats.total;
            document.getElementById('statWinRate').innerText = (stats.total > 0 ? Math.round((stats.wins / stats.total) * 100) : 0) + '%';
        }

        function saveState() {
            localStorage.setItem('nt_balance', balance);
            localStorage.setItem('nt_stats', JSON.stringify(stats));
            localStorage.setItem('nt_history', JSON.stringify(history.slice(0, 50)));
        }

        function log(msg, color, shouldSave = true) {
            const entry = document.createElement('div');
            entry.className = `log-entry ${color}`;
            entry.innerHTML = `<span class="text-muted">[${new Date().toLocaleTimeString([], {hour12: false})}]</span> ${msg}`;
            document.getElementById('txLog').prepend(entry);
            if (shouldSave) { history.unshift({ msg, color }); saveState(); }
        }

        function exportLogs() {
            const data = history.map(h => `[${new Date().toISOString()}] ${h.msg}`).join('\n');
            const blob = new Blob([data], { type: 'text/plain' });
            const anchor = document.createElement('a');
            anchor.href = window.URL.createObjectURL(blob);
            anchor.download = 'GreenProtocol_Audit.txt';
            anchor.click();
        }

        function resetSystem() {
            if(confirm("Confirm Factory Reset?")) { localStorage.clear(); location.reload(); }
        }
    </script>
</body>
</html>
