<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>NeonTrade Futures • Green Protocol</title>

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500&family=Rajdhani:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Bootstrap 5.3 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

  <!-- AOS -->
  <link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet">

  <style>
    :root {
      --neon-green: #00ff55;
      --neon-lime:  #ccff00;
      --dark-bg:    #000814;
      --glass:      rgba(0, 255, 85, 0.06);
      --glass-border: rgba(0, 255, 85, 0.25);
      --loss-red:   #ff2d55;
    }

    body {
      background: linear-gradient(to bottom, #000000, #0a1f0a);
      color: #e0ffe0;
      font-family: 'Inter', system-ui, sans-serif;
      min-height: 100vh;
      overflow-x: hidden;
    }

    h1, h2, h3, h4, h5, .display-*, .nav-link, .btn {
      font-family: 'Rajdhani', sans-serif;
      letter-spacing: 0.5px;
    }

    .glass {
      background: var(--glass);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid var(--glass-border);
      border-radius: 16px;
      box-shadow: 0 8px 32px rgba(0, 255, 85, 0.12);
    }

    .neon-text {
      color: var(--neon-green);
      text-shadow: 0 0 10px var(--neon-green), 0 0 20px var(--neon-green);
    }

    .btn-neon {
      background: linear-gradient(45deg, var(--neon-green), #00cc44);
      border: none;
      color: black;
      font-weight: 600;
      text-shadow: 0 0 8px rgba(0,0,0,0.6);
    }

    .btn-neon:hover {
      background: var(--neon-lime);
      transform: translateY(-1px);
      box-shadow: 0 0 25px var(--neon-lime);
    }

    .btn-danger {
      background: var(--loss-red);
      border: none;
    }

    #chartCanvas {
      image-rendering: pixelated;
      touch-action: none;
    }

    .streak-day {
      width: 38px;
      height: 38px;
      line-height: 38px;
      text-align: center;
      border-radius: 50%;
      font-weight: 600;
      transition: all 0.4s;
    }

    .streak-active {
      background: var(--neon-green);
      color: black;
      box-shadow: 0 0 20px var(--neon-green);
      transform: scale(1.15);
    }

    .badge-protocol {
      font-size: 1.1rem;
      padding: 0.6em 1.4em;
      background: linear-gradient(90deg, #00ff55, #00cc44);
      color: black;
    }

    @media (max-width: 576px) {
      .btn-lg { font-size: 1.1rem; padding: 1rem; }
      .streak-day { width: 32px; height: 32px; line-height: 32px; font-size: 0.85rem; }
    }
  </style>
</head>
<body>

<!-- Loading -->
<div id="loading" class="position-fixed top-0 start-0 w-100 h-100 bg-dark d-flex justify-content-center align-items-center" style="z-index:9999;">
  <div class="spinner-grow text-success" style="width:4rem;height:4rem;" role="status">
    <span class="visually-hidden">Loading...</span>
  </div>
</div>

<!-- Login -->
<div id="loginScreen" class="container d-flex align-items-center justify-content-center min-vh-100">
  <div class="card glass p-4 p-md-5 col-11 col-sm-9 col-md-7 col-lg-5" data-aos="zoom-in">
    <h1 class="text-center neon-text mb-2 fw-bold">NEONTRADE</h1>
    <div class="badge badge-protocol mx-auto mb-4">7-DAY GREEN PROTOCOL</div>

    <ul class="nav nav-tabs nav-justified mb-4" id="authTabs" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="access-tab" data-bs-toggle="tab" data-bs-target="#access" type="button">ACCESS</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="new-tab" data-bs-toggle="tab" data-bs-target="#new" type="button">NEW NODE</button>
      </li>
    </ul>

    <div class="tab-content">
      <div class="tab-pane fade show active" id="access">
        <form id="loginForm">
          <input type="email"    class="form-control mb-3 glass" placeholder="Node ID (email)" required>
          <input type="password" class="form-control mb-4 glass" placeholder="Quantum Key" required>
          <button type="submit" class="btn btn-neon btn-lg w-100">CONNECT</button>
        </form>
      </div>
      <div class="tab-pane fade" id="new">
        <form id="registerForm">
          <input type="email"    class="form-control mb-3 glass" placeholder="New Node ID" required>
          <input type="password" class="form-control mb-4 glass" placeholder="Create Quantum Key" required>
          <button type="submit" class="btn btn-neon btn-lg w-100">INITIALIZE NODE</button>
        </form>
      </div>
    </div>

    <p class="text-center mt-4 small opacity-75">
      Objective: Scale ₹1,000 → ₹10,000 in 7 solar cycles
    </p>
  </div>
</div>

<!-- Dashboard -->
<div id="dashboard" class="container py-4 d-none">
  <header class="d-flex flex-wrap justify-content-between align-items-center mb-4" data-aos="fade-down">
    <h4 class="m-0 neon-text">₹<span id="balance">1,000</span></h4>
    <div class="d-flex gap-3 align-items-center">
      <span class="badge bg-dark">Day <span id="currentDay">1</span>/7</span>
      <button id="aiToggle" class="btn btn-outline-success btn-sm"><i class="bi bi-cpu"></i> AI Pattern</button>
      <button id="logoutBtn" class="btn btn-outline-danger btn-sm">Disconnect</button>
    </div>
  </header>

  <!-- Streak -->
  <div class="d-flex justify-content-center gap-2 gap-md-3 mb-4 flex-wrap" data-aos="flip-up">
    <div class="streak-day bg-dark">1</div>
    <div class="streak-day bg-dark">2</div>
    <div class="streak-day bg-dark">3</div>
    <div class="streak-day bg-dark">4</div>
    <div class="streak-day bg-dark">5</div>
    <div class="streak-day bg-dark">6</div>
    <div class="streak-day bg-dark">7</div>
  </div>

  <!-- Chart -->
  <div class="card glass mb-4 overflow-hidden" data-aos="fade-up">
    <div class="card-header d-flex justify-content-between align-items-center">
      <h5 class="m-0">LIVE FEED • <span id="price">0.00000</span></h5>
      <div class="btn-group btn-group-sm">
        <button id="zoomIn"  class="btn btn-outline-light"><i class="bi bi-zoom-in"></i></button>
        <button id="zoomOut" class="btn btn-outline-light"><i class="bi bi-zoom-out"></i></button>
        <button id="reset"   class="btn btn-outline-light"><i class="bi bi-arrow-counterclockwise"></i></button>
      </div>
    </div>
    <canvas id="chartCanvas" height="280"></canvas>
  </div>

  <!-- Trade controls -->
  <div class="row g-3 mb-4">
    <div class="col-12 col-sm-5 col-md-4">
      <div class="glass p-3">
        <label class="form-label small">Amount (₹)</label>
        <input type="number" id="tradeAmount" class="form-control glass" value="100" min="50" step="50">
      </div>
    </div>
    <div class="col-12 col-sm-7 col-md-8">
      <div class="glass p-3">
        <label class="form-label small">Duration</label>
        <div class="btn-group w-100">
          <button class="btn btn-outline-light duration active" data-sec="5">5s</button>
          <button class="btn btn-outline-light duration" data-sec="15">15s</button>
          <button class="btn btn-outline-light duration" data-sec="60">60s</button>
        </div>
      </div>
    </div>
  </div>

  <div class="row g-3 mb-5">
    <div class="col-6">
      <button id="btnLong" class="btn btn-neon btn-lg w-100"><i class="bi bi-arrow-up-circle-fill"></i> LONG</button>
    </div>
    <div class="col-6">
      <button id="btnShort" class="btn btn-danger btn-lg w-100"><i class="bi bi-arrow-down-circle-fill"></i> SHORT</button>
    </div>
  </div>

  <!-- Stats -->
  <div class="row g-3 text-center mb-4">
    <div class="col-6 col-md-3" data-aos="fade-up"><div class="glass p-3"><small>Total</small><h5 id="totalTrades">0</h5></div></div>
    <div class="col-6 col-md-3" data-aos="fade-up" data-aos-delay="80"><div class="glass p-3"><small>Win Rate</small><h5 id="winRate">0%</h5></div></div>
    <div class="col-6 col-md-3" data-aos="fade-up" data-aos-delay="160"><div class="glass p-3"><small>Wins</small><h5 id="wins">0</h5></div></div>
    <div class="col-6 col-md-3" data-aos="fade-up" data-aos-delay="240"><div class="glass p-3"><small>Losses</small><h5 id="losses">0</h5></div></div>
  </div>

  <!-- Log -->
  <div class="card glass" data-aos="fade-up">
    <div class="card-header">Transmission Log</div>
    <div id="log" class="list-group list-group-flush" style="max-height:180px;overflow-y:auto;"></div>
  </div>
</div>

<!-- Mission Modal -->
<div class="modal fade" id="winModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content glass">
      <div class="modal-header border-0">
        <h5 class="modal-title neon-text">PROTOCOL COMPLETE</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body text-center">
        <h3 class="neon-text mb-4">₹10,000 TARGET REACHED</h3>
        <p class="mb-4">You have successfully breached the 7-day Green Protocol.</p>
        <button id="downloadCert" class="btn btn-neon">Download Certificate</button>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
<script>
AOS.init({duration:800,easing:'ease-out'});

let balance = 1000;
let wins = 0, losses = 0;
let aiEnabled = false;
let candles = [];
let zoom = 1, pan = 0;
let price = 142.75;
let forcedWin = null; // null | 'long' | 'short'
let forcedCounter = 0;
let currentDay = 1;
let selectedSeconds = 5;

const el = id => document.getElementById(id);
const log = txt => {
  const li = document.createElement('div');
  li.className = 'list-group-item bg-transparent border-0 small py-1';
  li.textContent = `[${new Date().toLocaleTimeString()}] ${txt}`;
  el('log').prepend(li);
  if (el('log').children.length > 20) el('log').lastElementChild.remove();
};

function updateUI() {
  el('balance').textContent = balance.toLocaleString();
  el('currentDay').textContent = currentDay;
  el('price').textContent = price.toFixed(2);
  el('totalTrades').textContent = wins + losses;
  el('winRate').textContent = (wins + losses ? ((wins / (wins + losses)) * 100).toFixed(0) : 0) + '%';
  el('wins').textContent = wins;
  el('losses').textContent = losses;

  if (balance >= 10000) {
    new bootstrap.Modal(el('winModal')).show();
  }
}

function generateCandle() {
  let dir = 0;
  if (forcedCounter > 0) {
    dir = forcedWin === 'long' ? 1 : -1;
    forcedCounter--;
  } else {
    dir = Math.random() > 0.48 ? 1 : -1;
  }

  const change = dir * (0.08 + Math.random() * 0.35);
  const prev = price;
  price = Math.max(10, price + change);

  return {
    open: prev,
    close: price,
    high: Math.max(prev, price) + Math.random() * 0.2,
    low:  Math.min(prev, price) - Math.random() * 0.2
  };
}

function draw() {
  const c = el('chartCanvas');
  const ctx = c.getContext('2d');
  const w = c.width = c.offsetWidth;
  const h = c.height;

  ctx.fillStyle = 'rgba(0,0,0,0.4)';
  ctx.fillRect(0,0,w,h);

  if (!candles.length) return;

  const vis = Math.floor(w / 14);
  const start = Math.max(0, candles.length - vis - pan);
  const slice = candles.slice(start, start + vis);

  const minP = Math.min(...slice.map(c=>c.low));
  const maxP = Math.max(...slice.map(c=>c.high));
  const range = maxP - minP || 1;

  slice.forEach((candle, i) => {
    const x = i * 14;
    const y = v => h - ((v - minP) / range * (h * 0.92)) - h*0.04;

    const top    = y(candle.high);
    const bottom = y(candle.low);
    const o      = y(candle.open);
    const cl     = y(candle.close);

    ctx.strokeStyle = cl > o ? '#00ff88' : '#ff4d4d';
    ctx.lineWidth = 1.5;

    // wick
    ctx.beginPath();
    ctx.moveTo(x+7, top);
    ctx.lineTo(x+7, bottom);
    ctx.stroke();

    // body
    ctx.fillStyle = ctx.strokeStyle;
    ctx.fillRect(x+2, Math.min(o,cl), 10, Math.max(Math.abs(o-cl),1));
  });
}

function tick() {
  candles.push(generateCandle());
  if (candles.length > 300) candles.shift();
  draw();
  if (aiEnabled && Math.random() < 0.18) {
    const dir = Math.random() > 0.5 ? 'long' : 'short';
    log(`AI PATTERN DETECTED → ${dir.toUpperCase()}`);
    forcedWin = dir;
    forcedCounter = 4 + Math.floor(Math.random()*4);
  }
}

function placeTrade(isLong) {
  const amt = Number(el('tradeAmount').value);
  if (amt < 50 || amt > balance) return alert('Invalid amount');

  balance -= amt;
  updateUI();
  log(`${isLong?'LONG':'SHORT'} • ₹${amt}`);

  const entry = price;
  let remaining = selectedSeconds;

  const tid = setInterval(() => {
    remaining--;
    if (remaining <= 0) {
      clearInterval(tid);
      const exit = price;
      const won = (isLong && exit > entry) || (!isLong && exit < entry);

      if (won) {
        const profit = Math.round(amt * 0.82);
        balance += amt + profit;
        wins++;
        log(`TARGET HIT  +₹${profit}`);
      } else {
        losses++;
        log(`STOP LOSS HIT  -₹${amt}`);
      }
      updateUI();
    }
  }, 1000);
}

// Events
el('loginForm').onsubmit = e => { e.preventDefault(); el('loginScreen').classList.add('d-none'); el('dashboard').classList.remove('d-none'); el('loading').style.display='none'; };
el('registerForm').onsubmit = e => { e.preventDefault(); el('loginScreen').classList.add('d-none'); el('dashboard').classList.remove('d-none'); el('loading').style.display='none'; };
el('logoutBtn').onclick = () => { location.reload(); };

el('aiToggle').onclick = () => {
  aiEnabled = !aiEnabled;
  el('aiToggle').classList.toggle('btn-success', aiEnabled);
  el('aiToggle').classList.toggle('btn-outline-success', !aiEnabled);
};

document.querySelectorAll('.duration').forEach(b=>{
  b.onclick=()=>{
    document.querySelectorAll('.duration').forEach(x=>x.classList.remove('active'));
    b.classList.add('active');
    selectedSeconds = +b.dataset.sec;
  };
});

el('btnLong').onclick  = () => placeTrade(true);
el('btnShort').onclick = () => placeTrade(false);

el('zoomIn').onclick  = () => { zoom = Math.min(zoom*1.4, 6); draw(); };
el('zoomOut').onclick = () => { zoom = Math.max(zoom/1.4, 0.4); draw(); };
el('reset').onclick   = () => { zoom=1; pan=0; draw(); };

let dragX = 0;
el('chartCanvas').onpointerdown = e=>{ dragX = e.clientX; };
el('chartCanvas').onpointermove = e=>{
  if (e.buttons !== 1) return;
  pan += Math.round((dragX - e.clientX)/8);
  pan = Math.max(0, pan);
  dragX = e.clientX;
  draw();
};

el('downloadCert').onclick = ()=>{
  const text = `NeonTrade Green Protocol Certificate\nNode: ${Math.random().toString(36).slice(2,10).toUpperCase()}\nAchieved: ₹10,000\nDate: ${new Date().toLocaleDateString('en-IN')}`;
  const a = document.createElement('a');
  a.href = 'data:text/plain;charset=utf-8,' + encodeURIComponent(text);
  a.download = 'neontrade_certificate.txt';
  a.click();
};

// Init
window.onload = ()=>{
  el('loading').style.display = 'none';
  for (let i=0; i<60; i++) candles.push(generateCandle());
  draw();
  setInterval(tick, 1800);
  updateUI();
  document.querySelector('.streak-day:nth-child(1)').classList.add('streak-active');
};
</script>
</body>
</html>
